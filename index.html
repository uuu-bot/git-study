<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="assessment.css">
  <title>あなたのいいところ診断</title>
</head>
<body>
  <h1>あなたのいいところは?</h1>
  <p>名前を入れて下さい</p>
  <input type="text" id="user-name" size="40" maxlength="20">
  <button id="assessment">診断する</button>
  <div id="result-area"></div>
  <div id="tweet-area">
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </div>
  <script>(function () {
    'use strict';
    const userNameInput = document.getElementById('user-name');
    const assessmentButton = document.getElementById('assessment');
    const resultDivided = document.getElementById('result-area');
    const tweetDivided = document.getElementById('tweet-area');
  
    /**
    * 指定した要素の子どもを全て除去する
    * @param {HTMLElement} element HTMLの要素
    */
    function removeAllChildren(element) {
      while (element.firstChild) { // 子どもの要素があるかぎり除去
        element.removeChild(element.firstChild);
      }
    }
  
    assessmentButton.onclick = () => {
      const userName = userNameInput.value;
      if (userName.length === 0) { // 名前が空の時は処理を終了する
        return;
      }
  
      // 診断結果表示エリアの作成
      removeAllChildren(resultDivided);
      const header = document.createElement('h3');
      header.innerText = '結果';
      resultDivided.appendChild(header);
  
      const paragraph = document.createElement('p');
      const result = assessment(userName);
      paragraph.innerText = result;
      resultDivided.appendChild(paragraph);
  
    };
  
    userNameInput.onkeydown = (event) => {
      if (event.keyCode === 13) {
        assessmentButton.onclick();
      }
    };
  
    const answers = [
      '{userName}あ{userName}あ',
      '{userName}い{userName}い',
      '{userName}う{userName}う',
      '{userName}え{userName}え',
      '{userName}お{userName}お',
      '{userName}か{userName}か',
      '{userName}き{userName}き',
      '{userName}く{userName}く。',
      '{userName}け{userName}け',
      '{userName}こ{userName}こ',
      '{userName}さ{userName}さ',
      '{userName}し{userName}し',
      '{userName}す{userName}す',
      '{userName}せ{userName}せ',
      '{userName}そ{userName}そ',
      '{userName}な{userName}な'
    ];
  
    /**
    * 名前の文字列を渡すと診断結果を返す関数
    * @param {string} userName ユーザーの名前
    * @return {string} 診断結果
    */
    function assessment(userName) {
      let sumOfCharCode = 0;
      for (let i = 0; i < userName.length; i++) {
        sumOfCharCode = sumOfCharCode + userName.charCodeAt(i);
      }
  
      
      const index = sumOfCharCode % answers.length;
      let result = answers[index];
  
      result = result.replace(/{userName}/g, userName);
      return result;
    }
  
    
    console.assert(
      assessment('太郎') === '太郎のいいところは決断力です。太郎がする決断にいつも助けられる人がいます。',
      '診断結果の文言の特定の部分を名前に置き換える処理が正しくありません。'
    );
    console.assert(
      assessment('太郎') === assessment('太郎'),
      '入力が同じ名前なら同じ診断結果を出力する処理が正しくありません。'
    );
  })();</script>
  <style>body {
    background-color: black;
    color: white;
    width: 500px;
    margin-right: auto;
    margin-left : auto;
  }
  button {
    padding: 5px 20px;
    background-color: red;
    color: white;
    border-color: red;
    border-style: none;
  }
  input {
    height: 20px;
  }</style>

</body>
</html>
